<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - สร้าง QR Code (Test Mode)</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Kanit:wght@400;500;700&display=swap');
        body { font-family: 'Kanit', sans-serif; background-color: #F7FAFC; display: flex; justify-content: center; align-items: center; min-height: 100vh; text-align: center; margin: 20px; }
        .admin-panel { background-color: #FFFFFF; padding: 40px; border-radius: 20px; box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1); width: 100%; max-width: 450px; }
        h1 { color: #2D3748; margin-bottom: 30px; }
        .form-group { margin-bottom: 20px; text-align: left; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: 500; color: #4A5568; }
        select { width: 100%; padding: 10px; border: 1px solid #E2E8F0; border-radius: 8px; font-size: 1em; font-family: 'Kanit', sans-serif; box-sizing: border-box; }
        #generate-btn { background: #00796B; color: white; border: none; padding: 15px 30px; font-size: 1.1em; font-family: 'Kanit', sans-serif; border-radius: 10px; cursor: pointer; transition: all 0.3s ease; width: 100%; }
        #generate-btn:hover { background: #004D40; transform: translateY(-3px); box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
        #generate-btn:disabled { background-color: #cccccc; cursor: not-allowed; }
        #qrcode-container { margin-top: 30px; padding: 20px; min-height: 256px; display: flex; justify-content: center; align-items: center; }
        #result-url { margin-top: 15px; font-size: 0.9em; color: #718096; word-wrap: break-word; }
    </style>
</head>
<body>
    <div class="admin-panel">
        <h1>ระบบสร้าง QR Code</h1>
        <div class="form-group">
            <label for="shop-select">เลือกร้านค้า:</label>
            <select id="shop-select">
                <option value="">-- กรุณาเลือกร้าน --</option>
            </select>
        </div>
        <p>กดปุ่มเพื่อสร้าง QR Code สำหรับลูกค้าร้านที่เลือก</p>
        <button id="generate-btn">สร้าง QR Code ใหม่</button>
        <div id="qrcode-container"></div>
        <p id="result-url"></p>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>

    <script>
        // ไม่ต้องเชื่อมต่อ Firebase ในเวอร์ชันทดสอบนี้
        
        // เชื่อม JavaScript กับ HTML elements
        const generateBtn = document.getElementById('generate-btn');
        const qrcodeContainer = document.getElementById('qrcode-container');
        const resultUrlElement = document.getElementById('result-url');
        const shopSelect = document.getElementById('shop-select');

        // --- ⭐⭐⭐ โค้ดสำหรับทดสอบ: ใส่ข้อมูลร้านค้าโดยตรง ⭐⭐⭐ ---
        // ฟังก์ชันนี้จะทำงานทันทีเมื่อหน้าเว็บโหลดเสร็จ
        window.onload = () => {
            console.log("โหมดทดสอบ: กำลังสร้างรายชื่อร้านค้าจำลอง");

            // จำลองว่าเรามีข้อมูลร้านค้า 1 ร้าน
            const fakeShops = [
                { id: 'k3MMdoZIRrqtpNu7kOJg', shopName: 'เฟื่องฟูAIR (ทดสอบ)' }
            ];
            
            // ล้างตัวเลือกเก่าทิ้ง
            shopSelect.innerHTML = '<option value="">-- กรุณาเลือกร้าน --</option>'; 
            
            // วนลูปเพื่อสร้างตัวเลือกใน Dropdown
            fakeShops.forEach((shop) => {
                const option = document.createElement('option');
                option.value = shop.id;
                option.textContent = shop.shopName;
                shopSelect.appendChild(option);
            });
        };

        // การทำงานของปุ่มสร้าง QR Code (ยังไม่ต้องเชื่อม Firebase)
        generateBtn.addEventListener('click', () => {
            const selectedShopId = shopSelect.value;
            if (!selectedShopId) {
                alert("กรุณาเลือกร้านค้าก่อนครับ!");
                return;
            }
            // ในโหมดทดสอบนี้ เราจะยังไม่สร้างข้อมูลใน Firebase
            // แต่จะสร้าง QR Code จากข้อมูลจำลอง
            qrcodeContainer.innerHTML = ''; // ล้างของเก่า
            const fakeAcId = 'TEST_AC_ID_' + Math.random().toString(36).substr(2, 9);
            const baseUrl = 'https://airtest01.netlify.app';
            const fullUrl = `${baseUrl}/index.html?shopId=${selectedShopId}&id=${fakeAcId}`;
            
            new QRCode(qrcodeContainer, { text: fullUrl, width: 256, height: 256 });
            resultUrlElement.innerText = `URL (ทดสอบ): ${fullUrl}`;
        });
    </script>
</body>
</html>